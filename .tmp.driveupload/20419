{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "9b46170d",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\tosea\\AppData\\Local\\Temp\\ipykernel_18564\\1517423758.py:4: DeprecationWarning: \n",
      "Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),\n",
      "(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)\n",
      "but was not found to be installed on your system.\n",
      "If this would cause problems for you,\n",
      "please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466\n",
      "        \n",
      "  import pandas as pd\n",
      "C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\scipy\\__init__.py:155: UserWarning: A NumPy version >=1.18.5 and <1.25.0 is required for this version of SciPy (detected version 1.26.4\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n"
     ]
    }
   ],
   "source": [
    "import time\n",
    "from datetime import datetime, timedelta\n",
    "from dateutil.relativedelta import *\n",
    "import pandas as pd\n",
    "import os\n",
    "import csv\n",
    "from scipy.stats import pearsonr\n",
    "import numpy as np\n",
    "import re\n",
    "import pytrends\n",
    "import bash\n",
    "import random\n",
    "import pdb\n",
    "import calendar\n",
    "import requests\n",
    "from requests.exceptions import Timeout\n",
    "from pytrends.exceptions import ResponseError\n",
    "from torpy.circuit import  CellTimeoutError"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "21a1afcb",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\tosea\\AppData\\Local\\Temp\\ipykernel_18564\\2402486769.py:7: DeprecationWarning: executable_path has been deprecated, please pass in a Service object\n",
      "  driver = webdriver.Edge(options = options, executable_path=edge_driver_path)\n"
     ]
    }
   ],
   "source": [
    "\n",
    "def get_cookie():\n",
    "    from selenium import webdriver\n",
    "    options = webdriver.EdgeOptions()\n",
    "    edge_driver_path = r'msedgedriver.exe'\n",
    "\n",
    "# Create a WebDriver instance for Microsoft Edge\n",
    "    driver = webdriver.Edge(options = options, executable_path=edge_driver_path)   \n",
    "    driver.get(\"https://trends.google.com/\")\n",
    "    time.sleep(5)\n",
    "    cookie = driver.get_cookie(\"NID\")[\"value\"]\n",
    "    driver.quit()\n",
    "    return cookie\n",
    "\n",
    "nid_cookie = f\"NID={get_cookie()}\"\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f5a667db",
   "metadata": {},
   "outputs": [],
   "source": [
    "from pytrends.request import TrendReq\n",
    "\n",
    "requests_args = {\n",
    "    'headers' : {\n",
    "        \"Cookie\": nid_cookie,\n",
    "    }\n",
    "}\n",
    " \n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "26b226d2",
   "metadata": {},
   "outputs": [],
   "source": [
    "def init():\n",
    "    from torpy import TorClient\n",
    "\n",
    "    hostname = 'ifconfig.me'  # It's possible use onion hostname here as well\n",
    "    with TorClient() as tor:\n",
    "        # Choose random guard node and create 3-hops circuit\n",
    "        with tor.create_circuit(3) as circuit:\n",
    "            # Create tor stream to host\n",
    "            with circuit.create_stream((hostname, 80)) as stream:\n",
    "                # Now we can communicate with host\n",
    "                stream.send(b'GET / HTTP/1.0\\r\\nHost: %s\\r\\n\\r\\n' % hostname.encode())\n",
    "                recv = stream.recv(1024)\n",
    "    return 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "eecf1545",
   "metadata": {},
   "outputs": [],
   "source": [
    "def column_name_to_mvt_and_remove_zero_values(df, geo_name):\n",
    "    df.rename(columns={df.columns[0]: f\"MVT_GT_{geo_name}\" }, inplace = True)\n",
    "    df = df[df[f\"MVT_GT_{geo_name}\"] != 0]\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "a5a6a136",
   "metadata": {},
   "outputs": [],
   "source": [
    "def execute_init():\n",
    "    while True:\n",
    "        try:\n",
    "            init()\n",
    "            print(\"init status completed\")\n",
    "            break\n",
    "        except (TimeoutError, CellTimeoutError, ConnectionResetError) as error:\n",
    "            print(f\"Init Error Occured: {error}\")\n",
    "            print(\"Let me sleep for 10 seconds\")\n",
    "            print(\"ZZzzzz...\")\n",
    "            time.sleep(10)\n",
    "            print(\"Was a nice sleep, now let me continue...\")\n",
    "            pass\n",
    "    return 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "bd4bb7b0",
   "metadata": {},
   "outputs": [],
   "source": [
    "def GT_temp_df(start_date, end_date, geo_code, geo_name):\n",
    "    \n",
    "    temp_df = pd.DataFrame()\n",
    "    while len(temp_df) == 0:\n",
    "\n",
    "        try:\n",
    "            pytrend.build_payload(mvt_keyword, cat=0, timeframe=f\"{start_date} {end_date}\", geo = geo_code)\n",
    "            temp_df = pytrend.interest_over_time()\n",
    "\n",
    "        except (ResponseError, Timeout, ConnectionAbortedError, ConnectionError) as error:\n",
    "            try:\n",
    "                print(f\"GT Error Occured: {error}\")\n",
    "                !pip install pytrends --upgrade\n",
    "                #init()\n",
    "                #rint(f\"Let's Go, Onion!\")\n",
    "                pytrend.build_payload(mvt_keyword, cat=0, timeframe=f\"{start_date} {end_date}\", geo = geo_code)\n",
    "                temp_df = pytrend.interest_over_time()\n",
    "\n",
    "            except (ResponseError, Timeout, ConnectionAbortedError, ConnectionError) as error:\n",
    "                print(f\"GT Error Occured: {error}\")\n",
    "                print(f\"Let me sleep for 1 day, till {(datetime.now() + timedelta(days=1)).strftime('%m/%d/%Y, %H:%M:%S')}\")\n",
    "                print(\"ZZzzzz...\")\n",
    "                time.sleep(random.randint(60*60*24, 60*60*24+30,))\n",
    "                print(\"Was a nice sleep, now let me continue...\")\n",
    "\n",
    "\n",
    "    print(f\"Obtaining GT MVT from {start_date} to {end_date} in {geo_name} metro area\")\n",
    "    time.sleep(random.randint(600, 660))\n",
    "    temp_df = column_name_to_mvt_and_remove_zero_values(temp_df, geo_name)\n",
    "    return temp_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "7575af2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def combine_df_and_temp_df_and_rescale_by_overlap_factors(df, temp_df):\n",
    "    df = pd.concat([df, temp_df.iloc[:, 0]], axis = 1)\n",
    "    if len(df.columns) > 1:\n",
    "        factor_data = df.dropna(how = \"any\")\n",
    "        factor_divided = factor_data.iloc[:, 0]/factor_data.iloc[:, 1]\n",
    "        adjusted_factor = factor_divided.mean()\n",
    "        df.iloc[:,1] = df.iloc[:,1]*adjusted_factor\n",
    "        df = df.mean(axis = 1)\n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "66539e2c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[WinError 10061] No connection could be made because the target machine actively refused it\n",
      "ERROR:root:[ignored]\n",
      "Traceback (most recent call last):\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\cell_socket.py\", line 63, in connect\n",
      "    self._socket.connect((self._router.ip, self._router.or_port))\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\ssl.py\", line 1342, in connect\n",
      "    self._real_connect(addr, False)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\ssl.py\", line 1329, in _real_connect\n",
      "    super().connect(addr)\n",
      "ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it\n",
      "\n",
      "During handling of the above exception, another exception occurred:\n",
      "\n",
      "Traceback (most recent call last):\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\utils.py\", line 79, in newfn\n",
      "    return func(*args, **kwargs)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 235, in renew\n",
      "    raw_string = self.download_consensus(prev_hash)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 183, in newfn\n",
      "    return func(*args, **kwargs)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 390, in download_consensus\n",
      "    with self._get_dir_client() as dir_client:\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 375, in _get_dir_client\n",
      "    self._dir_guard, self._dir_circuit = self._create_dir_circuit(purpose='Internal dir client')\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 365, in _create_dir_circuit\n",
      "    guard = TorGuard(router, purpose=purpose)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\guard.py\", line 66, in __init__\n",
      "    self.__tor_socket.connect()\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\cell_socket.py\", line 69, in connect\n",
      "    raise TorSocketConnectError(e)\n",
      "torpy.cell_socket.TorSocketConnectError: [WinError 10061] No connection could be made because the target machine actively refused it\n",
      "WARNING:torpy.utils:Retry with another router...\n",
      "ERROR:torpy.cell_socket:[WinError 10061] No connection could be made because the target machine actively refused it\n",
      "ERROR:root:[ignored]\n",
      "Traceback (most recent call last):\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\cell_socket.py\", line 63, in connect\n",
      "    self._socket.connect((self._router.ip, self._router.or_port))\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\ssl.py\", line 1342, in connect\n",
      "    self._real_connect(addr, False)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\ssl.py\", line 1329, in _real_connect\n",
      "    super().connect(addr)\n",
      "ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it\n",
      "\n",
      "During handling of the above exception, another exception occurred:\n",
      "\n",
      "Traceback (most recent call last):\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\utils.py\", line 79, in newfn\n",
      "    return func(*args, **kwargs)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 235, in renew\n",
      "    raw_string = self.download_consensus(prev_hash)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 183, in newfn\n",
      "    return func(*args, **kwargs)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 390, in download_consensus\n",
      "    with self._get_dir_client() as dir_client:\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 375, in _get_dir_client\n",
      "    self._dir_guard, self._dir_circuit = self._create_dir_circuit(purpose='Internal dir client')\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 365, in _create_dir_circuit\n",
      "    guard = TorGuard(router, purpose=purpose)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\guard.py\", line 66, in __init__\n",
      "    self.__tor_socket.connect()\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\cell_socket.py\", line 69, in connect\n",
      "    raise TorSocketConnectError(e)\n",
      "torpy.cell_socket.TorSocketConnectError: [WinError 10061] No connection could be made because the target machine actively refused it\n",
      "WARNING:torpy.utils:Retry with another router...\n",
      "ERROR:torpy.cell_socket:timed out\n",
      "ERROR:root:[ignored]\n",
      "Traceback (most recent call last):\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\cell_socket.py\", line 63, in connect\n",
      "    self._socket.connect((self._router.ip, self._router.or_port))\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\ssl.py\", line 1342, in connect\n",
      "    self._real_connect(addr, False)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\ssl.py\", line 1329, in _real_connect\n",
      "    super().connect(addr)\n",
      "socket.timeout: timed out\n",
      "\n",
      "During handling of the above exception, another exception occurred:\n",
      "\n",
      "Traceback (most recent call last):\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\utils.py\", line 79, in newfn\n",
      "    return func(*args, **kwargs)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 235, in renew\n",
      "    raw_string = self.download_consensus(prev_hash)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 183, in newfn\n",
      "    return func(*args, **kwargs)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 390, in download_consensus\n",
      "    with self._get_dir_client() as dir_client:\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 375, in _get_dir_client\n",
      "    self._dir_guard, self._dir_circuit = self._create_dir_circuit(purpose='Internal dir client')\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\consesus.py\", line 365, in _create_dir_circuit\n",
      "    guard = TorGuard(router, purpose=purpose)\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\guard.py\", line 66, in __init__\n",
      "    self.__tor_socket.connect()\n",
      "  File \"C:\\Users\\tosea\\anaconda3\\lib\\site-packages\\torpy\\cell_socket.py\", line 69, in connect\n",
      "    raise TorSocketConnectError(e)\n",
      "torpy.cell_socket.TorSocketConnectError: timed out\n",
      "WARNING:torpy.utils:Retry with another router...\n",
      "WARNING:torpy.consesus:Unknown voter present\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "init()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "0f3e3a90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#basic pytrend settings\n",
    "pytrend = TrendReq(retries=3, requests_args = requests_args)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "7e8795a5",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'\\nkw_list = [\"car stolen+find stolen car+report police stolen car+insurance car stolen-dream-check\",\\n    \"I raped+raped me+raped report police+being raped+been raped - dream - kobe - trump - porn\",\\n    \"my stolen+find my stolen+theft report police+someone stolen my - car - heart - dream - number\",\\n    \"burglary+home burglarized+my house broken into+my home broken into+burglary report police - dream\",\\n    \"my committed a crime+police arrested my+my arrested+my in jail+my in prison - arrested development\",\\n    \"I hate family+parents hate me+I hate my parents+I hate school+I hate teacher+I hate dad+I hate mom\"]\\n'"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "'''\n",
    "kw_list = [\"car stolen+find stolen car+report police stolen car+insurance car stolen-dream-check\",\n",
    "    \"I raped+raped me+raped report police+being raped+been raped - dream - kobe - trump - porn\",\n",
    "    \"my stolen+find my stolen+theft report police+someone stolen my - car - heart - dream - number\",\n",
    "    \"burglary+home burglarized+my house broken into+my home broken into+burglary report police - dream\",\n",
    "    \"my committed a crime+police arrested my+my arrested+my in jail+my in prison - arrested development\",\n",
    "    \"I hate family+parents hate me+I hate my parents+I hate school+I hate teacher+I hate dad+I hate mom\"]\n",
    "'''\n",
    "#years = [i for i in range(2010, 2016)]\n",
    "#print(years)\n",
    "#months = [i for i in range(1, 13, 3)] \n",
    "#print(months)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "30921c43",
   "metadata": {},
   "source": [
    "### GT Keywords (Test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "2105a9d7",
   "metadata": {},
   "outputs": [],
   "source": [
    "mvt_keyword = [\"car stolen+find stolen car+report police stolen car+insurance car stolen-dream-check\"] "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "acaf14eb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#pytrend.build_payload(mvt_keyword, cat=0, timeframe=f\"{'2016-01-01'} {'2023-12-31'}\", geo = \"US-NY-501\")\n",
    "#temp_df = pytrend.interest_over_time()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "753dfe1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "#temp_df.to_csv(\"test.csv\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8df312d7",
   "metadata": {},
   "source": [
    "### Geo Location and Geo Codes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "8273e0bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Top 50 the most populous cities in the U.S.\n",
    "region_code_dict = {\n",
    "    \"US-NY-501\": \"New York NY\",\n",
    "    \"US-CA-807\": \"San Francisco-Oakland-San Jose CA\", #including Oakland, CA and San Jose CA\n",
    "    \"US-CA-803\": \"Los Angeles CA\", #including Long Beach, CA\n",
    "    \"US-CA-825\": \"San Diego CA\", \n",
    "    \"US-CA-862\": \"Sacramento-Stockton-Modesto CA\",\n",
    "    \"US-AZ-753\": \"Phoenix AZ\", #including Mesa, AZ\n",
    "    \"US-MI-505\": \"Detroit MI\",\n",
    "    \"US-NC-517\" : \"Charlotte NC\",\n",
    "    \"US-OH-535\" : \"Columbus OH\",\n",
    "    \"US-FL-561\" : \"Jacksonville FL\",\n",
    "    \"US-MD-511\" : \"Washington DC (Hagerstown MD)\", # including Arlington VA\n",
    "    \"US-OK-650\" : \"Oklahoma City OK\",\n",
    "    \"US-TX-765\" : \"El Paso TX\",\n",
    "    \"US-OR-820\" : \"Portland OR\",\n",
    "    \"US-MD-512\" : \"Baltimore MD\",\n",
    "    \"US-WI-617\" : \"Milwaukee WI\",\n",
    "    \"US-NM-790\" : \"Albuquerque-Santa Fe NM\",\n",
    "    \"US-CA-866\" : \"Fresno-Visalia CA\",\n",
    "    \"US-MO-616\" : \"Kansas City MO\",\n",
    "    \"US-NE-652\" : \"Omaha NE\",\n",
    "    \"US-CO-752\" : \"Colorado Springs-Pueblo CO\",\n",
    "    \"US-NC-560\" : \"Raleigh-Durham (Fayetteville) NC\",\n",
    "    \"US-VA-544\" : \"Norfolk-Portsmouth-Newport News VA\", #including Virginia Beach, VA\n",
    "    \"US-FL-528\" : \"Miami-Ft. Lauderdale FL\",\n",
    "    \"US-CA-800\" : \"Bakersfield CA\",\n",
    "    \"US-OK-671\" : \"Tulsa OK\",\n",
    "    \"US-KS-678\" : \"Wichita-Hutchinson KS\"  ,\n",
    "    \"US-NV-839\":\"Las Vegas NV\",\n",
    "    \"US-WA-819\":\"Seattle-Tacoma WA\",\n",
    "    \"US-CO-751\":\"Denver CO\", #including Aurora, CO\n",
    "    \"US-PA-504\":\"Philadelphia PA\",\n",
    "    \"US-GA-524\":\"Atlanta GA\",\n",
    "    \"US-IN-602\":\"Chicago IL\",\n",
    "    \"US-NH-506\":\"Boston MA-Manchester NH\",\n",
    "    \"CA-ON\":\"Ontario\",\n",
    "    \"US-KY-529\" : \"Louisville KY\",\n",
    "    \"US-TN-640\" : \"Memphis TN\",\n",
    "    \"US-WI-613\" : \"Minneapolis-St. Paul MN\",\n",
    "    \"US-TN-659\" : \"Nashville TN\",\n",
    "    \"US-AZ-789\" : \"Tucson AZ\",\n",
    "    \"US-TX-623\" : \"Dallas-Ft. Worth TX\", # including Fort Worth, TX\n",
    "    \"US-TX-641\" : \"San Antonio TX\",\n",
    "    \"US-TX-618\" : \"Houston TX\",\n",
    "    \"US-TX-635\" : \"Austin TX\",\n",
    "}\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "720ed6be",
   "metadata": {},
   "outputs": [],
   "source": [
    "region_dict = {value: key for key, value in region_code_dict.items()}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "2429ee25",
   "metadata": {},
   "outputs": [],
   "source": [
    "# reverse the diction order \n",
    "from collections import OrderedDict\n",
    " \n",
    "# Reverse Dictionary Keys Order\n",
    "reversed_dict = OrderedDict(reversed(list(region_dict.items())))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "165194c8",
   "metadata": {},
   "source": [
    "### Dates (From, To)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "5a40f85c",
   "metadata": {},
   "outputs": [],
   "source": [
    "From  = [\"2015-01-01\"]\n",
    "\n",
    "To = [\"2022-12-31\"]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a6f40044",
   "metadata": {},
   "source": [
    "## Execute Pytrends to Pull Daily Data from Google Trends"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "48a26924",
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240223_22_47 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240223_22_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240223_23_08 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240223_23_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240223_23_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240223_23_40 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240223_23_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240224_00_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240224_00_11 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240224_00_21 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240224_00_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240224_00_42 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240224_00_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240224_01_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240224_01_14 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240224_01_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240224_01_35 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240224_01_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240224_01_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240224_02_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240224_02_17 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240224_02_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240224_02_38 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240224_02_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240224_02_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240224_03_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240224_03_20 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240224_03_31 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240224_03_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240224_03_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240224_04_02 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240224_04_13 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240224_04_23 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240224_04_34 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240224_04_44 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240224_04_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240224_05_04 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240224_05_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240224_05_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240224_05_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240224_05_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240224_05_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240224_06_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240224_06_18 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240224_06_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240224_06_38 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240224_06_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240224_06_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240224_07_10 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240224_07_20 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240224_07_31 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240224_07_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240224_07_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240224_08_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240224_08_13 file saved\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240224_08_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240224_08_34 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240224_08_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240224_08_55 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240224_09_06 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240224_09_16 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240224_09_27 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240224_09_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240224_09_47 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240224_09_58 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240224_10_08 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240224_10_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240224_10_29 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240224_10_40 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240224_10_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240224_11_02 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240224_11_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240224_11_23 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240224_11_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240224_11_44 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240224_11_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240224_12_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240224_12_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240224_12_25 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240224_12_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240224_12_47 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240224_12_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240224_13_08 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240224_13_18 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240224_13_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240224_13_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240224_13_50 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240224_14_00 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240224_14_11 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240224_14_22 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240224_14_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240224_14_43 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240224_14_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240224_15_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240224_15_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240224_15_25 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240224_15_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240224_15_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240224_15_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240224_16_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240224_16_18 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240224_16_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240224_16_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240224_16_50 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240224_17_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240224_17_11 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240224_17_22 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240224_17_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240224_17_43 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240224_17_54 file saved\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240224_18_04 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240224_18_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
<<<<<<< HEAD
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240224_18_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n"
=======
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240219_06_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240219_07_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240219_07_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240219_07_22 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240219_07_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240219_07_44 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240219_07_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240219_08_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240219_08_16 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240219_08_27 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240219_08_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240219_08_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240219_08_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240219_09_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240219_09_20 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240219_09_31 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240219_09_42 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240219_09_53 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240219_10_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240219_10_13 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240219_10_23 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240219_10_34 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240219_10_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240219_10_55 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240219_11_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240219_11_16 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240219_11_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240219_11_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240219_11_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240219_11_58 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240219_12_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240219_12_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240219_12_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240219_12_40 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240219_12_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240219_13_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240219_13_11 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240219_13_22 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240219_13_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240219_13_43 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240219_13_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240219_14_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240219_14_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240219_14_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240219_14_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240219_14_47 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240219_14_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240219_15_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240219_15_17 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240219_15_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240219_15_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240219_15_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240219_15_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240219_16_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240219_16_20 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240219_16_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240219_16_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240219_16_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240219_17_02 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240219_17_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240219_17_22 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240219_17_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240219_17_42 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240219_17_53 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240219_18_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240219_18_14 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240219_18_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240219_18_35 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240219_18_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240219_18_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240219_19_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240219_19_17 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240219_19_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240219_19_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240219_19_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240219_19_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240219_20_10 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240219_20_20 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240219_20_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240219_20_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240219_20_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240219_21_02 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240219_21_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240219_21_23 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240219_21_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240219_21_44 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240219_21_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240219_22_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240219_22_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240219_22_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240219_22_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240219_22_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240219_22_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240219_23_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240219_23_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240219_23_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240219_23_40 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240219_23_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240220_00_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240220_00_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240220_00_23 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240220_00_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240220_00_44 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240220_00_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240220_01_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240220_01_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240220_01_25 file saved\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240220_01_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240220_01_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240220_01_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240220_02_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240220_02_18 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240220_02_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240220_02_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240220_02_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240220_03_00 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240220_03_11 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240220_03_21 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240220_03_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240220_03_42 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240220_03_53 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240220_04_04 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240220_04_14 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240220_04_25 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240220_04_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240220_04_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240220_04_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240220_05_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240220_05_17 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240220_05_27 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240220_05_38 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240220_05_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240220_05_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240220_06_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240220_06_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240220_06_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240220_06_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240220_06_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240220_07_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240220_07_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240220_07_23 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240220_07_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240220_07_43 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240220_07_53 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240220_08_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240220_08_14 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240220_08_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240220_08_35 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240220_08_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240220_08_55 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240220_09_06 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240220_09_16 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240220_09_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240220_09_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240220_09_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240220_09_58 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240220_10_08 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240220_10_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240220_10_29 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240220_10_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240220_10_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240220_10_59 file saved\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240220_11_10 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240220_11_20 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240220_11_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240220_11_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240220_11_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240220_12_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240220_12_13 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240220_12_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240220_12_35 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240220_12_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240220_12_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240220_13_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240220_13_17 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240220_13_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240220_13_39 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240220_13_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240220_14_00 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240220_14_10 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240220_14_21 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240220_14_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240220_14_42 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240220_14_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240220_15_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240220_15_14 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240220_15_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240220_15_34 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240220_15_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240220_15_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240220_16_06 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240220_16_16 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240220_16_27 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240220_16_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240220_16_47 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240220_16_58 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240220_17_08 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240220_17_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240220_17_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240220_17_40 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240220_17_50 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240220_18_01 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240220_18_12 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240220_18_22 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240220_18_33 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240220_18_43 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240220_18_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240220_19_04 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240220_19_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240220_19_25 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240220_19_36 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240220_19_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240220_19_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240220_20_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240220_20_18 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240220_20_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240220_20_39 file saved\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240220_20_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240220_21_00 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240220_21_10 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240220_21_21 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Kansas City MO metro area\n",
      "Kansas City MO_monthly_2015-01-01_2022-12-31_20240220_21_32 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Fresno-Visalia CA metro area\n",
      "Fresno-Visalia CA_monthly_2015-01-01_2022-12-31_20240220_21_43 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Albuquerque-Santa Fe NM metro area\n",
      "Albuquerque-Santa Fe NM_monthly_2015-01-01_2022-12-31_20240220_21_54 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Milwaukee WI metro area\n",
      "Milwaukee WI_monthly_2015-01-01_2022-12-31_20240220_22_05 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Baltimore MD metro area\n",
      "Baltimore MD_monthly_2015-01-01_2022-12-31_20240220_22_15 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Portland OR metro area\n",
      "Portland OR_monthly_2015-01-01_2022-12-31_20240220_22_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in El Paso TX metro area\n",
      "El Paso TX_monthly_2015-01-01_2022-12-31_20240220_22_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Oklahoma City OK metro area\n",
      "Oklahoma City OK_monthly_2015-01-01_2022-12-31_20240220_22_48 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Washington DC (Hagerstown MD) metro area\n",
      "Washington DC (Hagerstown MD)_monthly_2015-01-01_2022-12-31_20240220_22_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Jacksonville FL metro area\n",
      "Jacksonville FL_monthly_2015-01-01_2022-12-31_20240220_23_09 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Columbus OH metro area\n",
      "Columbus OH_monthly_2015-01-01_2022-12-31_20240220_23_19 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Charlotte NC metro area\n",
      "Charlotte NC_monthly_2015-01-01_2022-12-31_20240220_23_30 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Detroit MI metro area\n",
      "Detroit MI_monthly_2015-01-01_2022-12-31_20240220_23_41 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Phoenix AZ metro area\n",
      "Phoenix AZ_monthly_2015-01-01_2022-12-31_20240220_23_51 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Sacramento-Stockton-Modesto CA metro area\n",
      "Sacramento-Stockton-Modesto CA_monthly_2015-01-01_2022-12-31_20240221_00_02 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Diego CA metro area\n",
      "San Diego CA_monthly_2015-01-01_2022-12-31_20240221_00_13 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Los Angeles CA metro area\n",
      "Los Angeles CA_monthly_2015-01-01_2022-12-31_20240221_00_24 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Francisco-Oakland-San Jose CA metro area\n",
      "San Francisco-Oakland-San Jose CA_monthly_2015-01-01_2022-12-31_20240221_00_35 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in New York NY metro area\n",
      "New York NY_monthly_2015-01-01_2022-12-31_20240221_00_45 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Austin TX metro area\n",
      "Austin TX_monthly_2015-01-01_2022-12-31_20240221_00_55 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Houston TX metro area\n",
      "Houston TX_monthly_2015-01-01_2022-12-31_20240221_01_06 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in San Antonio TX metro area\n",
      "San Antonio TX_monthly_2015-01-01_2022-12-31_20240221_01_16 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Dallas-Ft. Worth TX metro area\n",
      "Dallas-Ft. Worth TX_monthly_2015-01-01_2022-12-31_20240221_01_26 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tucson AZ metro area\n",
      "Tucson AZ_monthly_2015-01-01_2022-12-31_20240221_01_37 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Nashville TN metro area\n",
      "Nashville TN_monthly_2015-01-01_2022-12-31_20240221_01_47 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Minneapolis-St. Paul MN metro area\n",
      "Minneapolis-St. Paul MN_monthly_2015-01-01_2022-12-31_20240221_01_57 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Memphis TN metro area\n",
      "Memphis TN_monthly_2015-01-01_2022-12-31_20240221_02_07 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Louisville KY metro area\n",
      "Louisville KY_monthly_2015-01-01_2022-12-31_20240221_02_18 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Ontario metro area\n",
      "Ontario_monthly_2015-01-01_2022-12-31_20240221_02_28 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Boston MA-Manchester NH metro area\n",
      "Boston MA-Manchester NH_monthly_2015-01-01_2022-12-31_20240221_02_38 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Chicago IL metro area\n",
      "Chicago IL_monthly_2015-01-01_2022-12-31_20240221_02_49 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Atlanta GA metro area\n",
      "Atlanta GA_monthly_2015-01-01_2022-12-31_20240221_02_59 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Philadelphia PA metro area\n",
      "Philadelphia PA_monthly_2015-01-01_2022-12-31_20240221_03_10 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Denver CO metro area\n",
      "Denver CO_monthly_2015-01-01_2022-12-31_20240221_03_21 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Seattle-Tacoma WA metro area\n",
      "Seattle-Tacoma WA_monthly_2015-01-01_2022-12-31_20240221_03_31 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Las Vegas NV metro area\n",
      "Las Vegas NV_monthly_2015-01-01_2022-12-31_20240221_03_42 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Wichita-Hutchinson KS metro area\n",
      "Wichita-Hutchinson KS_monthly_2015-01-01_2022-12-31_20240221_03_52 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Tulsa OK metro area\n",
      "Tulsa OK_monthly_2015-01-01_2022-12-31_20240221_04_03 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Bakersfield CA metro area\n",
      "Bakersfield CA_monthly_2015-01-01_2022-12-31_20240221_04_14 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Miami-Ft. Lauderdale FL metro area\n",
      "Miami-Ft. Lauderdale FL_monthly_2015-01-01_2022-12-31_20240221_04_25 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Norfolk-Portsmouth-Newport News VA metro area\n",
      "Norfolk-Portsmouth-Newport News VA_monthly_2015-01-01_2022-12-31_20240221_04_35 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Raleigh-Durham (Fayetteville) NC metro area\n",
      "Raleigh-Durham (Fayetteville) NC_monthly_2015-01-01_2022-12-31_20240221_04_46 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Colorado Springs-Pueblo CO metro area\n",
      "Colorado Springs-Pueblo CO_monthly_2015-01-01_2022-12-31_20240221_04_56 file saved\n",
      "Obtaining GT MVT from 2015-01-01 to 2022-12-31 in Omaha NE metro area\n",
      "Omaha NE_monthly_2015-01-01_2022-12-31_20240221_05_07 file saved\n"
     ]
    },
    {
     "ename": "RetryError",
     "evalue": "HTTPSConnectionPool(host='trends.google.com', port=443): Max retries exceeded with url: /trends/api/widgetdata/multiline?req=%7B%22time%22%3A+%222015-01-01+2022-12-31%22%2C+%22resolution%22%3A+%22MONTH%22%2C+%22locale%22%3A+%22en-US%22%2C+%22comparisonItem%22%3A+%5B%7B%22geo%22%3A+%7B%22dma%22%3A+%22616%22%7D%2C+%22complexKeywordsRestriction%22%3A+%7B%22keyword%22%3A+%5B%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22car+stolen%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22find+stolen+car%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22report+police+stolen+car%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22insurance+car+stolen-dream-check%22%7D%5D%2C+%22operator%22%3A+%22OR%22%7D%7D%5D%2C+%22requestOptions%22%3A+%7B%22property%22%3A+%22%22%2C+%22backend%22%3A+%22IZG%22%2C+%22category%22%3A+0%7D%2C+%22userConfig%22%3A+%7B%22userType%22%3A+%22USER_TYPE_SCRAPER%22%7D%7D&token=APP6_UEAAAAAZdccyQNcNqLrhpcUa0y6FT4y3EuDv204&tz=360 (Caused by ResponseError('too many 429 error responses'))",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mMaxRetryError\u001b[0m                             Traceback (most recent call last)",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\requests\\adapters.py\u001b[0m in \u001b[0;36msend\u001b[1;34m(self, request, stream, timeout, verify, cert, proxies)\u001b[0m\n\u001b[0;32m    488\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0mchunked\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 489\u001b[1;33m                 resp = conn.urlopen(\n\u001b[0m\u001b[0;32m    490\u001b[0m                     \u001b[0mmethod\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mrequest\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmethod\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\urllib3\\connectionpool.py\u001b[0m in \u001b[0;36murlopen\u001b[1;34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\u001b[0m\n\u001b[0;32m    877\u001b[0m             \u001b[0mlog\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Retry: %s\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 878\u001b[1;33m             return self.urlopen(\n\u001b[0m\u001b[0;32m    879\u001b[0m                 \u001b[0mmethod\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\urllib3\\connectionpool.py\u001b[0m in \u001b[0;36murlopen\u001b[1;34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\u001b[0m\n\u001b[0;32m    877\u001b[0m             \u001b[0mlog\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Retry: %s\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 878\u001b[1;33m             return self.urlopen(\n\u001b[0m\u001b[0;32m    879\u001b[0m                 \u001b[0mmethod\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\urllib3\\connectionpool.py\u001b[0m in \u001b[0;36murlopen\u001b[1;34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\u001b[0m\n\u001b[0;32m    877\u001b[0m             \u001b[0mlog\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Retry: %s\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 878\u001b[1;33m             return self.urlopen(\n\u001b[0m\u001b[0;32m    879\u001b[0m                 \u001b[0mmethod\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\urllib3\\connectionpool.py\u001b[0m in \u001b[0;36murlopen\u001b[1;34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)\u001b[0m\n\u001b[0;32m    867\u001b[0m             \u001b[1;32mtry\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 868\u001b[1;33m                 \u001b[0mretries\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mretries\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mincrement\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmethod\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mresponse\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mresponse\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_pool\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    869\u001b[0m             \u001b[1;32mexcept\u001b[0m \u001b[0mMaxRetryError\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\urllib3\\util\\retry.py\u001b[0m in \u001b[0;36mincrement\u001b[1;34m(self, method, url, response, error, _pool, _stacktrace)\u001b[0m\n\u001b[0;32m    591\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mnew_retry\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mis_exhausted\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 592\u001b[1;33m             \u001b[1;32mraise\u001b[0m \u001b[0mMaxRetryError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0m_pool\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0merror\u001b[0m \u001b[1;32mor\u001b[0m \u001b[0mResponseError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mcause\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    593\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mMaxRetryError\u001b[0m: HTTPSConnectionPool(host='trends.google.com', port=443): Max retries exceeded with url: /trends/api/widgetdata/multiline?req=%7B%22time%22%3A+%222015-01-01+2022-12-31%22%2C+%22resolution%22%3A+%22MONTH%22%2C+%22locale%22%3A+%22en-US%22%2C+%22comparisonItem%22%3A+%5B%7B%22geo%22%3A+%7B%22dma%22%3A+%22616%22%7D%2C+%22complexKeywordsRestriction%22%3A+%7B%22keyword%22%3A+%5B%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22car+stolen%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22find+stolen+car%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22report+police+stolen+car%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22insurance+car+stolen-dream-check%22%7D%5D%2C+%22operator%22%3A+%22OR%22%7D%7D%5D%2C+%22requestOptions%22%3A+%7B%22property%22%3A+%22%22%2C+%22backend%22%3A+%22IZG%22%2C+%22category%22%3A+0%7D%2C+%22userConfig%22%3A+%7B%22userType%22%3A+%22USER_TYPE_SCRAPER%22%7D%7D&token=APP6_UEAAAAAZdccyQNcNqLrhpcUa0y6FT4y3EuDv204&tz=360 (Caused by ResponseError('too many 429 error responses'))",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[1;31mRetryError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_6556\\724748959.py\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      6\u001b[0m         \u001b[1;32mfor\u001b[0m \u001b[0mstart_date\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mend_date\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mzip\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mFrom\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mTo\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      7\u001b[0m             \u001b[1;31m#Get daily estimates with adjusted factors [mean(old/new) * new]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 8\u001b[1;33m             \u001b[0mtemp_df\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mGT_temp_df\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mstart_date\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mend_date\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mgeo_code\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mgeo_name\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      9\u001b[0m             \u001b[0mdf\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mcombine_df_and_temp_df_and_rescale_by_overlap_factors\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdf\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mtemp_df\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     10\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\AppData\\Local\\Temp\\ipykernel_6556\\391089997.py\u001b[0m in \u001b[0;36mGT_temp_df\u001b[1;34m(start_date, end_date, geo_code, geo_name)\u001b[0m\n\u001b[0;32m      6\u001b[0m         \u001b[1;32mtry\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      7\u001b[0m             \u001b[0mpytrend\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mbuild_payload\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmvt_keyword\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mcat\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m0\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mtimeframe\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;34mf\"{start_date} {end_date}\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mgeo\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mgeo_code\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 8\u001b[1;33m             \u001b[0mtemp_df\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpytrend\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0minterest_over_time\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      9\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     10\u001b[0m         \u001b[1;32mexcept\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mResponseError\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mTimeout\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mConnectionAbortedError\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mConnectionError\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;32mas\u001b[0m \u001b[0merror\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\pytrends\\request.py\u001b[0m in \u001b[0;36minterest_over_time\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    230\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    231\u001b[0m         \u001b[1;31m# make the request and parse the returned json\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 232\u001b[1;33m         req_json = self._get_data(\n\u001b[0m\u001b[0;32m    233\u001b[0m             \u001b[0murl\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mTrendReq\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mINTEREST_OVER_TIME_URL\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    234\u001b[0m             \u001b[0mmethod\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mTrendReq\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mGET_METHOD\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\AppData\\Roaming\\Python\\Python39\\site-packages\\pytrends\\request.py\u001b[0m in \u001b[0;36m_get_data\u001b[1;34m(self, url, method, trim_chars, **kwargs)\u001b[0m\n\u001b[0;32m    138\u001b[0m                               **self.requests_args)  # DO NOT USE retries or backoff_factor here\n\u001b[0;32m    139\u001b[0m         \u001b[1;32melse\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 140\u001b[1;33m             response = s.get(url, timeout=self.timeout, cookies=self.cookies,\n\u001b[0m\u001b[0;32m    141\u001b[0m                              **kwargs, **self.requests_args)  # DO NOT USE retries or backoff_factor here\n\u001b[0;32m    142\u001b[0m         \u001b[1;31m# check if the response contains json and throw an exception otherwise\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\requests\\sessions.py\u001b[0m in \u001b[0;36mget\u001b[1;34m(self, url, **kwargs)\u001b[0m\n\u001b[0;32m    598\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    599\u001b[0m         \u001b[0mkwargs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0msetdefault\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"allow_redirects\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;32mTrue\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 600\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mrequest\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"GET\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    601\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    602\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0moptions\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0murl\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\requests\\sessions.py\u001b[0m in \u001b[0;36mrequest\u001b[1;34m(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)\u001b[0m\n\u001b[0;32m    585\u001b[0m         }\n\u001b[0;32m    586\u001b[0m         \u001b[0msend_kwargs\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mupdate\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0msettings\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 587\u001b[1;33m         \u001b[0mresp\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0msend\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mprep\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0msend_kwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    588\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    589\u001b[0m         \u001b[1;32mreturn\u001b[0m \u001b[0mresp\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\requests\\sessions.py\u001b[0m in \u001b[0;36msend\u001b[1;34m(self, request, **kwargs)\u001b[0m\n\u001b[0;32m    699\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    700\u001b[0m         \u001b[1;31m# Send the request\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 701\u001b[1;33m         \u001b[0mr\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0madapter\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0msend\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mrequest\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    702\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    703\u001b[0m         \u001b[1;31m# Total elapsed time of the request (approximately)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\requests\\adapters.py\u001b[0m in \u001b[0;36msend\u001b[1;34m(self, request, stream, timeout, verify, cert, proxies)\u001b[0m\n\u001b[0;32m    554\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    555\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0me\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mreason\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mResponseError\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 556\u001b[1;33m                 \u001b[1;32mraise\u001b[0m \u001b[0mRetryError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0me\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrequest\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mrequest\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    557\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    558\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0me\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mreason\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0m_ProxyError\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mRetryError\u001b[0m: HTTPSConnectionPool(host='trends.google.com', port=443): Max retries exceeded with url: /trends/api/widgetdata/multiline?req=%7B%22time%22%3A+%222015-01-01+2022-12-31%22%2C+%22resolution%22%3A+%22MONTH%22%2C+%22locale%22%3A+%22en-US%22%2C+%22comparisonItem%22%3A+%5B%7B%22geo%22%3A+%7B%22dma%22%3A+%22616%22%7D%2C+%22complexKeywordsRestriction%22%3A+%7B%22keyword%22%3A+%5B%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22car+stolen%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22find+stolen+car%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22report+police+stolen+car%22%7D%2C+%7B%22type%22%3A+%22BROAD%22%2C+%22value%22%3A+%22insurance+car+stolen-dream-check%22%7D%5D%2C+%22operator%22%3A+%22OR%22%7D%7D%5D%2C+%22requestOptions%22%3A+%7B%22property%22%3A+%22%22%2C+%22backend%22%3A+%22IZG%22%2C+%22category%22%3A+0%7D%2C+%22userConfig%22%3A+%7B%22userType%22%3A+%22USER_TYPE_SCRAPER%22%7D%7D&token=APP6_UEAAAAAZdccyQNcNqLrhpcUa0y6FT4y3EuDv204&tz=360 (Caused by ResponseError('too many 429 error responses'))"
>>>>>>> b04f9e55a07788d8869ebcc251362b9b7dbd8c59
     ]
    }
   ],
   "source": [
    "\n",
    "#Get 100 times weekly GT MVT data per city\n",
    "for times in range(100):\n",
    "    for geo_name, geo_code in zip(reversed_dict.keys(), reversed_dict.values()):\n",
    "        df = pd.DataFrame()\n",
    "\n",
    "        for start_date, end_date in zip(From, To):\n",
    "            #Get daily estimates with adjusted factors [mean(old/new) * new]\n",
    "            temp_df = GT_temp_df(start_date, end_date, geo_code, geo_name)\n",
    "            df = combine_df_and_temp_df_and_rescale_by_overlap_factors(df, temp_df)\n",
    "\n",
    "        df.name = f\"MVT_GT_{geo_name}\"\n",
    "        df.to_csv(f\"C:/Users/tosea/GT-MVT-Monthly-City/csv_files/{geo_name}_monthly_{From[0]}_{To[-1]}_{pd.Timestamp.now().strftime('%Y%m%d_%H_%M')}.csv\")\n",
    "        print(f\"{geo_name}_monthly_{From[0]}_{To[-1]}_{pd.Timestamp.now().strftime('%Y%m%d_%H_%M')} file saved\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "015e589e",
   "metadata": {},
   "outputs": [],
   "source": [
    "test.plot(figsize=(20, 12),  kind ='line')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "edc81da1",
   "metadata": {},
   "outputs": [],
   "source": [
    "[print(i/25*23) for i in test2[\"car stolen+find stolen car+report police stolen car+insurance car stolen-dream-check\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ffdf2371",
   "metadata": {},
   "outputs": [],
   "source": [
    "kw_list=['Facebook', 'Apple', 'Amazon', 'Netflix', 'Google']\n",
    "pytrend = TrendReq()\n",
    "#search interest per region\n",
    "#run model for keywords (can also be competitors)\n",
    "pytrend.build_payload(kw_list, timeframe='today 1-m')\n",
    "\n",
    "# Interest by Region\n",
    "regiondf = pytrend.interest_by_region()\n",
    "#looking at rows where all values are not equal to 0\n",
    "regiondf = regiondf[(regiondf != 0).all(1)]\n",
    "\n",
    "#drop all rows that have null values in all columns\n",
    "regiondf.dropna(how='all',axis=0, inplace=True)\n",
    "\n",
    "#visualise\n",
    "regiondf.plot(figsize=(20, 12), y=kw_list, kind ='bar')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ecad1d3c",
   "metadata": {},
   "outputs": [],
   "source": [
    "historicaldf = pytrend.get_historical_interest(['Facebook', 'Apple', 'Amazon', 'Netflix', 'Google'], \n",
    "                                               year_start=2020, month_start=1, day_start=1, hour_start=0, \n",
    "                                               year_end=2020, month_end=12, day_end=31, hour_end=0, \n",
    "                                               cat=0, geo='en-US', gprop='', sleep=0)\n",
    "\n",
    "#visualise\n",
    "#plot a timeseries chart\n",
    "historicaldf.plot(figsize=(20, 12))\n",
    "\n",
    "#plot seperate graphs, using theprovided keywords\n",
    "historicaldf.plot(subplots=True, figsize=(20, 12))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "dfd89f89",
   "metadata": {},
   "outputs": [],
   "source": [
    "def gt_func(start_date_list, end_date_list, resolution, sample_size, path):\n",
    "#get monthly GT data\n",
    "    import inflect\n",
    "    #give ordinal names to numbers\n",
    "    p = inflect.engine()\n",
    "\n",
    "    for t in range(sample_size): #sample from GT 100 times\n",
    "        #time.sleep(random.randint(21600,21668)) # 6 hrs\n",
    "        print(f\"The {p.ordinal(t+1)} pull from GT\")\n",
    "        qt_list = [\"Q1\",\"Q2\",\"Q3\",\"Q4\"]\n",
    "        count = 0\n",
    "        for i, j in zip(start_date_list, end_date_list):\n",
    "            df = pd.DataFrame()\n",
    "            #Q1 - Q4\n",
    "            if count == 4:\n",
    "                count = 0\n",
    "            for k in kw_list:\n",
    "                #q = the name of the quarter\n",
    "                q = qt_list[count]\n",
    "                try:\n",
    "                    pytrend.build_payload(k, cat=0, timeframe=f'{i.strftime(\"%Y-%m-%d\")} {j.strftime(\"%Y-%m-%d\")}',  geo='US', gprop='')\n",
    "                    df = pd.concat([df, pytrend.interest_by_region(resolution=\"DMA\", inc_low_vol = False, inc_geo_code = False)], axis = 1)\n",
    "                    time.sleep(random.randint(120, 130))\n",
    "\n",
    "                except (Timeout, ResponseError) as e:\n",
    "                        print(f'!!{i.strftime(\"%Y-%m-%d\")} {j.strftime(\"%Y-%m-%d\")}!! ReadTimeoutError')\n",
    "                        print(f\"Whoops! ReadTimeoutError, the {p.ordinal(t+1)} pull aborted, now we take a rest\")\n",
    "                        print(dt.datetime.now().strftime(\"%Y/%m/%d_%H:%M:%S\"))\n",
    "                        time.sleep(random.randint(86668, 86888)) # 24 hrs\n",
    "                        print(f\"Rest enough, now we continue!\")\n",
    "\n",
    "                        #continue working\n",
    "                        pytrend.build_payload(k, cat=0, timeframe=f'{i.strftime(\"%Y-%m-%d\")} {j.strftime(\"%Y-%m-%d\")}',  geo='US', gprop='')\n",
    "                        df = pd.concat([df, pytrend.interest_by_region(resolution=\"DMA\", inc_low_vol=False, inc_geo_code=False)], axis = 1)\n",
    "                        time.sleep(random.randint(120, 130))\n",
    "\n",
    "            df.columns = [f\"MVT_{i.strftime('%Y')}_{q}\", \n",
    "                          f\"rape_{i.strftime('%Y')}_{q}\", \n",
    "                          f\"larceny_{i.strftime('%Y')}_{q}\", \n",
    "                          f\"burglary_{i.strftime('%Y')}_{q}\", \n",
    "                          f\"known_deliq_{i.strftime('%Y')}_{q}\", \n",
    "                          f\"low_social_cont_{i.strftime('%Y')}_{q}\"]\n",
    "            df.to_csv(f'{path}gt_crime_{i.strftime(\"%Y\")}_{q}_{dt.datetime.now().strftime(\"%Y%m%d_%H-%M-%S\")}.csv')\n",
    "            count += 1\n",
    "        print(f\"The {p.ordinal(t+1)} pull from GT Done!!\")\n",
    "        print(f'Time finished: {dt.datetime.now().strftime(\"%Y/%m/%d, %H:%M\")}')\n",
    "        time.sleep(random.randint(10800,10868)) # 3 hrs\n",
    "\n",
    "\n",
    "    print(f\"Congratulations, Well Done!\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
